# Load rehh package
library(rehh)
#load PopGenome package
install.packages("PopGenome")
#install and load vcfR package
library(PopGenome)
install.packages("vcfR")
library(vcfR)
#Read the data into R
hh <- data2haplohh(hap_file = "/Users/lexiperez/Desktop/Genome Data (no tbi)/FADS1-3.HC3202_chr11.60799627-62891545.vcf.gz", polarize_vcf = FALSE, vcf_reader = "data.table")
#* Reading input file(s) *
#Using package 'data.table' to read vcf.
#Extracting map information.
#Extracting haplotypes.
#Number of individuals which are 
#Haploid Diploid Triploid, ... : 
#1 2 
#0 3202 
#No marker identifiers found in vcf file.
#* Filtering data *
#Discard markers genotyped on less than 100 % of haplotypes.
#158 markers discarded.
#2202 markers remaining.
#Data consists of 6404 haplotypes and 2202 markers.
#Number of mono-, bi-, multi-allelic markers:
#1 2 3 4 5 6 7 
#0 2085 103 10 0 1 3 
res <- calc_ehh(hh, mrk = 1, include_nhaplo = TRUE)
#To show the vector with the frequencies of all the alleles of the focal marker. 
res$freq
#      FREQ_A       FREQ_D 
#0.9998438476 0.0001561524
res$ehh
#    POSITION      EHH_A EHH_D NHAPLO_A NHAPLO_D
#1   60799641 1.00000000     0     6403        1
#2   60799676 0.99875117     0     6403        0
#3   60799694 0.99719135     0     6403        0
#4   60799757 0.50107623     0     6403        0
#5   60799770 0.49365308     0     6403        0
#6   60799781 0.49307463     0     6403        0
#7   60799799 0.49278559     0     6403        0
#8   60799802 0.47194641     0     6403        0
#9   60799812 0.47128735     0     6403        0
#10  60799854 0.47095802     0     6403        0
#11  60799855 0.47032731     0     6403        0
#12  60799862 0.46967001     0     6403        0
#13  60799876 0.46950574     0     6403        0
#14  60799885 0.46950574     0     6403        0
#15  60799895 0.46936873     0     6403        0
#16  60799942 0.46920451     0     6403        0
#17  60799977 0.46904033     0     6403        0
#18  60799984 0.46887620     0     6403        0
#19  60799989 0.46823993     0     6403        0
#20  60800013 0.46048115     0     6403        0
#21  60800018 0.45647051     0     6403        0
#22  60800052 0.42873418     0     6403        0
#23  60800061 0.42873418     0     6403        0
#24  60800116 0.42873237     0     6403        0
#25  60800129 0.42858093     0     6403        0
#26  60800151 0.42812704     0     6403        0
#27  60800156 0.42812474     0     6403        0
#28  60800232 0.42812474     0     6403        0
#29  60800237 0.31091882     0     6403        0
#30  60800246 0.31091706     0     6403        0
#31  60800260 0.31060090     0     6403        0
#32  60800263 0.30861549     0     6403        0
#33  60800267 0.30854206     0     6403        0
#34  60800290 0.30846868     0     6403        0
#35  60800342 0.30744419     0     6403        0
#36  60800365 0.30729772     0     6403        0
#37  60800379 0.30722454     0     6403        0
#38  60800387 0.30699181     0     6403        0
#39  60800394 0.30699117     0     6403        0
#40  60800431 0.30683617     0     6403        0
#41  60800444 0.30654977     0     6403        0
#42  60800450 0.30641399     0     6403        0
#43  60800455 0.30627825     0     6403        0
#44  60800468 0.30600698     0     6403        0
#45  60800504 0.30600698     0     6403        0
#46  60800539 0.28720000     0     6403        0
#47  60800554 0.28599547     0     6403        0
#48  60800604 0.28586422     0     6403        0
#49  60800615 0.28573303     0     6403        0
#50  60800638 0.28566340     0     6403        0
#51  60800682 0.14953984     0     6403        0
#52  60800689 0.14951803     0     6403        0
#53  60800709 0.14946465     0     6403        0
#54  60800727 0.14584897     0     6403        0
#55  60800739 0.14582721     0     6403        0
#56  60800742 0.14096563     0     6403        0
#57  60800785 0.09670544     0     6403        0
#58  60800858 0.09665938     0     6403        0
#59  60800863 0.09611508     0     6403        0
#60  60800865 0.09598237     0     6403        0
#61  60800874 0.09593666     0     6403        0
#62  60800875 0.09590567     0     6403        0
#63  60800876 0.09554736     0     6403        0
#64  60800897 0.09554229     0     6403        0
#65  60800918 0.09516055     0     6403        0
#66  60800937 0.09502443     0     6403        0
#67  60800938 0.09496720     0     6403        0
#68  60800940 0.09431854     0     6403        0
#69  60800943 0.09333449     0     6403        0
#70  60800950 0.09328165     0     6403        0
#71  60800969 0.09319188     0     6403        0
#72  60800995 0.09307434     0     6403        0
#73  60801019 0.09296896     0     6403        0
#74  60801032 0.09287938     0     6403        0
#75  60801034 0.09278448     0     6403        0
#76  60801035 0.09237460     0     6403        0
#77  60801038 0.09234449     0     6403        0
#78  60801040 0.07546154     0     6403        0
#79  60801044 0.07545618     0     6403        0
#80  60801095 0.07544295     0     6403        0
#81  60801114 0.07543925     0     6403        0
#82  60801146 0.07539460     0     6403        0
#83  60801152 0.07534830     0     6403        0
#84  60801177 0.07440465     0     6403        0
#85  60801228 0.07421398     0     6403        0
#86  60801255 0.07415095     0     6403        0
#87  60801264 0.07415095     0     6403        0
#88  60801274 0.07413558     0     6403        0
#89  60801289 0.07410621     0     6403        0
#90  60801290 0.07410621     0     6403        0
#91  60801295 0.07409181     0     6403        0
#92  60801302 0.07404795     0     6403        0
#93  60801315 0.07403668     0     6403        0
#94  60801320 0.07399169     0     6403        0
#95  60801321 0.07399169     0     6403        0
#96  60801334 0.07396891     0     6403        0
#97  60801351 0.07396076     0     6403        0
#98  60801377 0.07394373     0     6403        0
#99  60801387 0.07385630     0     6403        0
#100 60801392 0.07385006     0     6403        0
#101 60801397 0.07385006     0     6403        0
#102 60801425 0.07383776     0     6403        0
#103 60801428 0.07375575     0     6403        0
#104 60801439 0.07375565     0     6403        0
#105 60801442 0.07374257     0     6403        0
#106 60801460 0.07372979     0     6403        0
#107 60801470 0.07328346     0     6403        0
#108 60801501 0.07323847     0     6403        0
#109 60801504 0.07323847     0     6403        0
#110 60801552 0.07323843     0     6403        0
#111 60801593 0.07323516     0     6403        0
#112 60801594 0.07279414     0     6403        0
#113 60801604 0.07279414     0     6403        0
#114 60801606 0.07278956     0     6403        0
#115 60801607 0.07278956     0     6403        0
#116 60801643 0.07277546     0     6403        0
#117 60801644 0.07249018     0     6403        0
#118 60801645 0.07222442     0     6403        0
#119 60801653 0.07221330     0     6403        0
#120 60801670 0.07220530     0     6403        0
#121 60801680 0.07203136     0     6403        0
#122 60801691 0.07193217     0     6403        0
#123 60801707 0.07193217     0     6403        0
#124 60801750 0.07188987     0     6403        0
#125 60801753 0.07188958     0     6403        0
#126 60801765 0.07188958     0     6403        0
#127 60801777 0.06983357     0     6403        0
3128 60801779 0.06983357     0     6403        0
#129 60801810 0.06983342     0     6403        0
#130 60801816 0.06974804     0     6403        0
#131 60801825 0.06970540     0     6403        0
#132 60801828 0.06970540     0     6403        0
#133 60801839 0.06954805     0     6403        0
#134 60801868 0.06954756     0     6403        0
#135 60801882 0.06951272     0     6403        0
#136 60801883 0.06945945     0     6403        0
#137 60801900 0.06942461     0     6403        0
#138 60801902 0.06931049     0     6403        0
#139 60801912 0.06878419     0     6403        0
#140 60801968 0.06875502     0     6403        0
#141 60801974 0.06867041     0     6403        0
#142 60801977 0.06852614     0     6403        0
#143 60801986 0.06845832     0     6403        0
#144 60802043 0.06845510     0     6403        0
#145 60802046 0.06845510     0     6403        0
#146 60802054 0.06845510     0     6403        0
#147 60802061 0.06837660     0     6403        0
#148 60802062 0.06833445     0     6403        0
#149 60802085 0.06833445     0     6403        0
#150 60802095 0.06833445     0     6403        0
#151 60802107 0.06830532     0     6403        0
#152 60802109 0.06830532     0     6403        0
#153 60802128 0.06822120     0     6403        0
#154 60802153 0.06820920     0     6403        0
#155 60802207 0.06819822     0     6403        0
#156 60802210 0.06819505     0     6403        0
#157 60802212 0.06291446     0     6403        0
#158 60802231 0.06288070     0     6403        0
#159 60802245 0.06288060     0     6403        0
#160 60802260 0.05576082     0     6403        0
#161 60802337 0.05574867     0     6403        0
#162 60802348 0.05574867     0     6403        0
#163 60802385 0.05574341     0     6403        0
#164 60802426 0.05573682     0     6403        0
#165 60802440 0.05492564     0     6403        0
#166 60802444 0.05492564     0     6403        0
#167 60802480 0.05492564     0     6403        0
#168 60802523 0.05488948     0     6403        0
#169 60802541 0.05484947     0     6403        0
#170 60802542 0.05479659     0     6403        0
#171 60802597 0.05479639     0     6403        0
#172 60802602 0.05479634     0     6403        0
#173 60802607 0.05476029     0     6403        0
#174 60802635 0.05476029     0     6403        0
#175 60802640 0.05472428     0     6403        0
#176 60802678 0.05469569     0     6403        0
#177 60802679 0.05468696     0     6403        0
#178 60802690 0.05464182     0     6403        0
#179 60802718 0.05443603     0     6403        0
#180 60802742 0.05440036     0     6403        0
#181 60802768 0.05439978     0     6403        0
#182 60802777 0.05439090     0     6403        0
#183 60802838 0.05439090     0     6403        0
#184 60802842 0.05435967     0     6403        0
#185 60802869 0.05430000     0     6403        0
#186 60802883 0.05430000     0     6403        0
#187 60802912 0.05429376     0     6403        0
#188 60802961 0.05416085     0     6403        0
#189 60802985 0.05415841     0     6403        0
#190 60803115 0.05395989     0     6403        0
#191 60803129 0.05395486     0     6403        0
#192 60803142 0.05395486     0     6403        0
#193 60803162 0.05394867     0     6403        0
#194 60803215 0.05389544     0     6403        0
#195 60803251 0.05379507     0     6403        0
#196 60803259 0.05379507     0     6403        0
#197 60803275 0.05379473     0     6403        0
#198 60803276 0.05368452     0     6403        0
#199 60803330 0.05368452     0     6403        0
#To plot the EHH values
plot(res)
#For Marker 2
res2 <- calc_ehh(hh, mrk=2, include_nhaplo = TRUE)
#Now, calculaute the vector with the frequencies of all alleles of the focal marker.
res2$freq
#      FREQ_A       FREQ_D 
#0.9993753904 0.0006246096 
#Data frame with the EHH values for each allele of the focal marker. 
res2$ehh
    POSITION      EHH_A EHH_D NHAPLO_A NHAPLO_D
1   60799641 0.99968750   1.0     6400        4
2   60799676 1.00000000   1.0     6400        4
3   60799694 0.99843848   1.0     6400        4
4   60799757 0.50171330   0.5     6400        4
5   60799770 0.49428099   0.5     6400        4
6   60799781 0.49370199   0.5     6400        4
7   60799799 0.49341269   0.5     6400        4
8   60799802 0.47255396   0.5     6400        4
9   60799812 0.47189409   0.5     6400        4
10  60799854 0.47156436   0.5     6400        4
11  60799855 0.47093291   0.5     6400        4
12  60799862 0.47027480   0.5     6400        4
13  60799876 0.47011032   0.5     6400        4
14  60799885 0.47011032   0.5     6400        4
15  60799895 0.46997319   0.5     6400        4
16  60799942 0.46980876   0.5     6400        4
17  60799977 0.46964438   0.5     6400        4
18  60799984 0.46948005   0.5     6400        4
19  60799989 0.46884303   0.5     6400        4
20  60800013 0.46107463   0.5     6400        4
21  60800018 0.45705901   0.5     6400        4
22  60800052 0.42928773   0.5     6400        4
23  60800061 0.42928773   0.5     6400        4
24  60800116 0.42928592   0.5     6400        4
25  60800129 0.42913429   0.5     6400        4
26  60800151 0.42867982   0.5     6400        4
27  60800156 0.42867753   0.5     6400        4
28  60800232 0.42867753   0.5     6400        4
29  60800237 0.31128809   0.5     6400        4
30  60800246 0.31128633   0.5     6400        4
31  60800260 0.31096983   0.5     6400        4
32  60800263 0.30898256   0.5     6400        4
33  60800267 0.30890906   0.5     6400        4
34  60800290 0.30883561   0.5     6400        4
35  60800342 0.30781016   0.5     6400        4
36  60800365 0.30766355   0.5     6400        4
37  60800379 0.30759030   0.5     6400        4
38  60800387 0.30735720   0.5     6400        4
39  60800394 0.30735657   0.5     6400        4
40  60800431 0.30720132   0.5     6400        4
41  60800444 0.30691461   0.5     6400        4
42  60800450 0.30677870   0.5     6400        4
43  60800455 0.30664283   0.5     6400        4
44  60800468 0.30637131   0.5     6400        4
45  60800504 0.30637131   0.5     6400        4
46  60800539 0.28754532   0.5     6400        4
47  60800554 0.28633888   0.5     6400        4
48  60800604 0.28620751   0.5     6400        4
49  60800615 0.28607619   0.5     6400        4
50  60800638 0.28600650   0.5     6400        4
51  60800682 0.14970181   0.5     6400        4
52  60800689 0.14967993   0.5     6400        4
53  60800709 0.14962650   0.5     6400        4
54  60800727 0.14600743   0.5     6400        4
55  60800739 0.14598560   0.5     6400        4
56  60800742 0.14111907   0.5     6400        4
57  60800785 0.09681654   0.5     6400        4
58  60800858 0.09677044   0.5     6400        4
59  60800863 0.09622553   0.5     6400        4
60  60800865 0.09609270   0.5     6400        4
61  60800874 0.09604689   0.5     6400        4
62  60800875 0.09601588   0.5     6400        4
63  60800876 0.09565718   0.5     6400        4
64  60800897 0.09565210   0.5     6400        4
65  60800918 0.09526992   0.5     6400        4
66  60800937 0.09513366   0.5     6400        4
67  60800938 0.09507638   0.5     6400        4
68  60800940 0.09442711   0.5     6400        4
69  60800943 0.09344204   0.5     6400        4
70  60800950 0.09338915   0.5     6400        4
71  60800969 0.09329929   0.5     6400        4
72  60800995 0.09318155   0.5     6400        4
73  60801019 0.09307607   0.5     6400        4
74  60801032 0.09298640   0.5     6400        4
75  60801034 0.09289137   0.5     6400        4
76  60801035 0.09248110   0.5     6400        4
77  60801038 0.09245097   0.5     6400        4
78  60801040 0.07554398   0.5     6400        4
79  60801044 0.07553861   0.5     6400        4
80  60801095 0.07552538   0.5     6400        4
81  60801114 0.07552166   0.5     6400        4
82  60801146 0.07547698   0.5     6400        4
83  60801152 0.07543063   0.5     6400        4
84  60801177 0.07448610   0.5     6400        4
85  60801228 0.07429520   0.5     6400        4
86  60801255 0.07423211   0.5     6400        4
87  60801264 0.07423211   0.5     6400        4
88  60801274 0.07421672   0.5     6400        4
89  60801289 0.07418732   0.5     6400        4
90  60801290 0.07418732   0.5     6400        4
91  60801295 0.07417292   0.5     6400        4
92  60801302 0.07412901   0.5     6400        4
93  60801315 0.07411773   0.5     6400        4
94  60801320 0.07407271   0.5     6400        4
95  60801321 0.07407271   0.5     6400        4
96  60801334 0.07404990   0.5     6400        4
97  60801351 0.07404174   0.5     6400        4
98  60801377 0.07402470   0.5     6400        4
99  60801387 0.07393719   0.5     6400        4
100 60801392 0.07393094   0.5     6400        4
101 60801397 0.07393094   0.5     6400        4
102 60801425 0.07391858   0.5     6400        4
103 60801428 0.07383649   0.5     6400        4
104 60801439 0.07383639   0.5     6400        4
105 60801442 0.07382330   0.5     6400        4
106 60801460 0.07381046   0.5     6400        4
107 60801470 0.07336366   0.5     6400        4
108 60801501 0.07331863   0.5     6400        4
109 60801504 0.07331863   0.5     6400        4
110 60801552 0.07331858   0.5     6400        4
111 60801593 0.07331531   0.5     6400        4
112 60801594 0.07287369   0.5     6400        4
113 60801604 0.07287369   0.5     6400        4
114 60801606 0.07286910   0.5     6400        4
115 60801607 0.07286910   0.5     6400        4
116 60801643 0.07285499   0.5     6400        4
117 60801644 0.07256940   0.5     6400        4
118 60801645 0.07230339   0.5     6400        4
119 60801653 0.07229225   0.5     6400        4
120 60801670 0.07228424   0.5     6400        4
121 60801680 0.07211010   0.5     6400        4
122 60801691 0.07201081   0.5     6400        4
123 60801707 0.07201081   0.5     6400        4
124 60801750 0.07196847   0.5     6400        4
125 60801753 0.07196818   0.5     6400        4
126 60801765 0.07196818   0.5     6400        4
127 60801777 0.06990980   0.5     6400        4
128 60801779 0.06990980   0.5     6400        4
129 60801810 0.06990965   0.5     6400        4
130 60801816 0.06982419   0.5     6400        4
131 60801825 0.06978151   0.5     6400        4
132 60801828 0.06978151   0.5     6400        4
133 60801839 0.06962401   0.5     6400        4
134 60801868 0.06962353   0.5     6400        4
135 60801882 0.06958866   0.5     6400        4
136 60801883 0.06953528   0.5     6400        4
137 60801900 0.06950041   0.5     6400        4
138 60801902 0.06938618   0.5     6400        4
139 60801912 0.06885920   0.5     6400        4
140 60801968 0.06882999   0.5     6400        4
141 60801974 0.06874531   0.5     6400        4
142 60801977 0.06860090   0.5     6400        4
143 60801986 0.06853302   0.5     6400        4
144 60802043 0.06852980   0.5     6400        4
145 60802046 0.06852980   0.5     6400        4
146 60802054 0.06852980   0.5     6400        4
147 60802061 0.06845122   0.5     6400        4
148 60802062 0.06840903   0.5     6400        4
149 60802085 0.06840903   0.5     6400        4
150 60802095 0.06840903   0.5     6400        4
151 60802107 0.06837987   0.5     6400        4
152 60802109 0.06837987   0.5     6400        4
153 60802128 0.06829568   0.5     6400        4
154 60802153 0.06828367   0.5     6400        4
155 60802207 0.06827263   0.5     6400        4
156 60802210 0.06826946   0.5     6400        4
157 60802212 0.06298255   0.5     6400        4
158 60802231 0.06294875   0.5     6400        4
159 60802245 0.06294865   0.5     6400        4
160 60802260 0.05582220   0.5     6400        4
161 60802337 0.05581004   0.5     6400        4
162 60802348 0.05581004   0.5     6400        4
163 60802385 0.05580476   0.5     6400        4
164 60802426 0.05579817   0.5     6400        4
165 60802440 0.05498623   0.5     6400        4
166 60802444 0.05498623   0.5     6400        4
167 60802480 0.05498623   0.5     6400        4
168 60802523 0.05495004   0.5     6400        4
169 60802541 0.05491000   0.5     6400        4
170 60802542 0.05485706   0.5     6400        4
171 60802597 0.05485686   0.5     6400        4
172 60802602 0.05485681   0.5     6400        4
173 60802607 0.05482072   0.5     6400        4
174 60802635 0.05482072   0.5     6400        4
175 60802640 0.05478468   0.5     6400        4
176 60802678 0.05475607   0.5     6400        4
177 60802679 0.05474732   0.5     6400        4
178 60802690 0.05470210   0.5     6400        4
179 60802718 0.05449602   0.5     6400        4
180 60802742 0.05446032   0.5     6400        4
181 60802768 0.05445973   0.5     6400        4
182 60802777 0.05445084   0.5     6400        4
183 60802838 0.05445084   0.5     6400        4
184 60802842 0.05441959   0.5     6400        4
185 60802869 0.05435986   0.5     6400        4
186 60802883 0.05435986   0.5     6400        4
187 60802912 0.05435361   0.5     6400        4
188 60802961 0.05422048   0.5     6400        4
189 60802985 0.05421804   0.5     6400        4
190 60803115 0.05401933   0.5     6400        4
191 60803129 0.05401430   0.5     6400        4
192 60803142 0.05401430   0.5     6400        4
193 60803162 0.05400810   0.5     6400        4
194 60803215 0.05395472   0.5     6400        4
195 60803251 0.05385426   0.5     6400        4
196 60803259 0.05385426   0.5     6400        4
197 60803275 0.05385392   0.5     6400        4
198 60803276 0.05374341   0.5     6400        4
199 60803330 0.05374341   0.5     6400        4
200 60803379 0.00000000   0.5     6400        4
 [ reached 'max' / getOption("max.print") -- omitted 296 rows ]
#Now to plot the EHH values
plot(res2)
scan <- scan_hh(hh)

 
